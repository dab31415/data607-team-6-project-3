---
title: "Project 3 - SQL"
author: "Team 6"
output:
  prettydoc::html_pretty:
    theme: hpstr
    highlight: github
  pdf_document: default
editor_options: 
  chunk_output_type: console
---

# Team 6 - Project 3 SQL


Load libraries
```{r}
# Database Interaction
library(DBI)
# Pulling data from GH
library(RCurl)
#string manipulation
library(stringr)
```



```{r}
con <- dbConnect(RSQLite::SQLite(), dbname = ":memory:")

```

## Create Tables
```{r}
baseUrl <- "https://raw.githubusercontent.com/nolivercuny/data607-team-6-project-3/master/sql/"
tables <- c("company.sql", "job_listing.sql")
for (table in tables) {
  fileUrl <- paste(baseUrl, table,sep = "")
  createTableStatement <- getURL(fileUrl)
  print(createTableStatement[1])
  dbListTables(con)
  dbSendQuery(con, createTableStatement[1])
  dbListTables(con)
  dbListFields(con, str_replace(table,".sql",""))
}

```


```{r}
dbDisconnect(con)
```

